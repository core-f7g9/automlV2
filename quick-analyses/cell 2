import pandas as pd

xlsx_path = "salesforce_cases.xlsx"  # change to your file name
df = pd.read_excel(xlsx_path, sheet_name=0, engine="openpyxl")

# Save CSV (useful if you later load into Athena/QuickSight)
csv_path = "salesforce_cases.csv"
df.to_csv(csv_path, index=False)

df.shape, df.columns

df.head(3)
df.isna().mean().sort_values(ascending=False).head(15)



# Missingness check for key fields
key_fields = [
    "text",
    "opened_at",
    "closed_at",
    "open_hours",
    EMAIL_COL,
    TYPE_COL,
    ORIGIN_COL
]

missing = (
    df[key_fields]
    .isna()
    .mean()
    .sort_values(ascending=False)
)

print("Fraction missing per key field:")
print(missing)

# Text length distribution
df["text_length"] = df["text"].str.len()

print("\nText length summary:")
print(df["text_length"].describe())

# Open duration sanity
print("\nOpen hours summary:")
print(df["open_hours"].describe())

print("\nFraction of tickets with open_hours == 0:")
print((df["open_hours"].fillna(0) == 0).mean())
