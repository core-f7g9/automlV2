from sklearn.cluster import KMeans
from sklearn.metrics.pairwise import cosine_distances

# Cluster embeddings into themes
kmeans_bedrock = KMeans(
    n_clusters=NUM_THEMES,
    random_state=42,
    n_init="auto"
)

df["theme_cluster_bedrock"] = kmeans_bedrock.fit_predict(embeddings)
cluster_counts = df["theme_cluster_bedrock"].value_counts().sort_index()

print("Tickets per Bedrock embedding theme:")
print(cluster_counts)
